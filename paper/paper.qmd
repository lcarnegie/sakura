---
title: "Warming Degrees and Flowering Trees"
subtitle: "Understanding Temperature's Role in Earlier Cherry Blossom Blooming Times in Kyoto, Japan"
author:
    - Luca Carnegie
    - Chris Lu
    - Russell Luchin
    - Randall Ni
abstract:
    This paper examines the relationship between temperature and cherry blossom (sakura) flowering dates in Kyoto, Japan, analyzing a comprehensive dataset spanning nearly 1200 years from 812 CE to present day. While previous research has focused on shorter timeframes, this analysis integrates historical records compiled by Aono (2010) with contemporary Japanese Meteorological Agency data to better understand how climate change affects the timing of this culturally significant phenomenon. By modeling flowering day as a function of mean March temperatures, we identify significant trends that have implications for the traditional practice of hanami (flower-viewing) and local ecosystems. Our findings demonstrate the need for cultural adaptation to shifting bloom schedules and highlight the importance of extensive historical climate data in developing accurate predictive models for natural phenomena affected by global warming.
format: pdf
bibliography: "references.bib"
execute:
    echo: false  # Hide code by default
    warning: false
    message: false
    jupyter: "python"
nocite: "@*" # display all references by default
thanks: "Code and workflow available at: https://github.com/lcarnegie/sakura" 
---

```{python}
#| label: data-setup

# Import necessary libraries 
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.dates as mdates
import seaborn as sns
import statsmodels.api as sm
import numpy as np
from matplotlib.colors import LinearSegmentedColormap
from matplotlib.ticker import MaxNLocator
from datetime import datetime
import pickle
import os
from statsmodels.iolib.summary2 import summary_col

# Load the historical data
historic_bloom = pd.read_csv("../data/analysis_data/historic_bloom.csv")

# Load the modern data
modern_bloom = pd.read_csv("../data/analysis_data/modern_bloom.csv")

# Truncate temperature to 1 decimal point
historic_bloom['avg_temp_march_c'] = historic_bloom['avg_temp_march_c'].round(1)
modern_bloom['avg_temp_march_c'] = modern_bloom['avg_temp_march_c'].round(1)

historic = historic_bloom
modern = modern_bloom

# Drop NaN values
historic = historic.dropna()
modern = modern.dropna()

```

# Introduction

Before the advent of modern technology, people understood themselves, their environments, and their cultures through the cycle of life and death. The Japanese tradition of *hanami* (loosely translated as 'flower-viewing') is an important cultural tradition that honors this perspective, being associated with the flowering birth of cherry blossom trees in the late spring. In the city of Kyoto in particular, local newspapers have recorded the dates of tree flowering since the late 19th century, but researchers like @Aono2010 have been able to corroborate flowering dates as far back as the year 812 CE, through the examination of historical records such as diaries, poetry and other written documents describing *hanami* parties throughout the ages. However, rising global temperatures have created anomalous climate conditions in recent years.  This highlights a need to understand the historical and modern links between temperature and cherry blossom bloom timing. Without it, cherished traditions like *hanami* may struggle to adapt to climate shifts, risking their disappearance as unique customs. 

Work such as @Allen2014 analyzes cherry blossom blooming data over a relatively brief 29-year timespan. However, this narrow temporal window represents only a fraction of the documented flowering history, limiting their model's ability to capture the relationship between blossoms and the significant climate shifts of the past 150 years - shifts that are clearly visible in @Aono2010's more comprehensive dataset.

We also seek to answer the question of whether warmer temperatures lead to earlier blooming times. To achieve this, we instead analyse and model the nearly 1200-year record compiled by @Aono2010 in tandem with modern data compiled by the Japanese Meteorological Agency (JMA), collected and compiled together by @Cookson. @sec-lit-review does a broad review of existing work surrounding cherry blossoms, their significance, and efforts to understand their behaviour related to climate. @sec-data covers the data sources, methodology, and conducts an exploratory analysis of the dataset. @sec-model proposes a model of cherry blossom flowering day as a function of mean March temperature in Kyoto and lists its results. @sec-discussion critically examines the data and results, comes to several conclusions about the dataset, and proposes new areas of exploration. This analysis highlights the  consequential effects for wildlife that function around the timing of blooming *sakura*, the need for flexibility in planning *hanami* celebrations going forward, as well as the need for wider ranging data to inform more precise predictions of blooming days.  


# Literature Review {#sec-lit-review}

The Japanese tradition of Hanami has become a cultural juggernaut for the nation, even spreading globally. Its cultural significance cannot be understated, which underscores the importance of being able to predict when the blooming season for cherry blossoms will begin. The cultural significance of Hanami is not only a historic and cultural cornerstone, but has also become an economic one.
Around the 8th century, sakura flowering had begun to assume special importance. Anthropologists note that in early Japanese agrarian society, cherry blossoms were closely tied to rice farming – the bloom of the cherries was believed to forecast the year’s rice harvest @CITEHanyan. Festivals would be conducted at shrines and the imperial court, where the emperor would offer prayers under blooming cherries for a bountiful autumn harvest @CITEHanyan. Sakura began to symbolize agrarian prosperity and “life power,” intimately linking Japanese livelihoods with seasonal rhythms of blooming @CITEHanyan. Furthermore, the blossoms started to be seen as extensions of imperial authority – one analysis notes that the emperor’s spiritual responsibility for the nation “extended ‘as far as cherries are in bloom’” @CITEHanyan, demonstrating how the flower was initially imbued with the cultural significance it holds now.

Cherry blossoms continued to ingrain themselves into Japanese culture. While Hanami was originally an aristocratic pastime, initiatives by Japanese leaders evolved into a widespread tradition shared by all classes lup.lub.lu.se. Historical records indicate feudal lords and government officials would encourage their subjects to participate in planting trees as well as the viewing of their bloom lup.lub.lu.se. Hanami gradually became widespread, and had begun to influence Japanese art and culture substantially. An exhibit and the Library of Congress reveals the extent to this influence, showing through several eras and lords that the cherry blossom remained a common motif to symbolize seasonal joy and life’s fleeting pleasures for the Japanese people @CITEcongress. There was also religious significance to the cherry blossom, due to the influence of Buddhism infused the practice of Hanami as a reminder of life’s impermanence @CITEHanyan. Thus, by the early modern period, the cultural symbolism of sakura had acquired multiple layers: on one hand, it represented renewal, beauty, and communal celebration, and on the other, a poignant reminder of mortality @CITEHanyan – regardless of its artistic symbolism, the widespread appreciation of the cherry blossom bloom had cemented the season as a cultural cornerstone.

This leads us to current day Japan. Sakura season is now a major economic and touristic phenomenon. The season is promoted by travel agencies, rail companies, and local tourism boards both domestically and internationally. Famous cherry blossom spots are must-see destinations each spring. As noted in @CITEjapantimes - “Hanami... has been a nationwide event for a long time in Japan. The beautiful sakura has now become a tourism asset, attracting foreign tourists”. Data highlights the sheer economic scale of the season: the estimated the economic effect of hanami in 2024 was ≈$7.7 billion USD in Japan, nearly double the previous year’s figure @CITEjapantimes. The economic impact of the cherry blossom is in no small part due to its cultural and historical significance in Japanese culture. This brings us to the importance of modelling this data. The surge of visitors to parks and landmarks during peak bloom sometimes creates logistical challenges, as vendors and tourist destinations must prepare for the influx of visitors domestic and international. Without adequate time to prepare for Hanami, locales risk being flooded which would cause a disruption to the revenue that Japan has come to expect @CITEmoriuchi.

To summarize, the tradition of Hanami in Japan can be considered timeless. It’s roots in agarian traditions has also cemented a practice of recording the data around cherry blossom blooming, due to its ties to the harvest and perceived prosperity. It’s gradual establishment in Japanese art and culture has also made in a juggernaut in that regard, cementing its place as a staple in Japanese culture. Despite no longer needing to track the blossoming for the harvest, a new necessity for the data collection has arisen: economic benefit. With ever changing circumstances due to climate change, accurately predicting the Hanami period is more important than ever, as the sheer scale of the event for Japan culturally and economically requires substantial preparation for the celebrations to run smoothly. Otherwise, Japan could risk losing reliable revenue or potentially damage its reputation as a global cultural powerhouse.

The relationship between sakura blooming date and other factors was next examined in depth. A notable amount of scholarship addresses the relationship between different variables and and the flowering dates of sakura, from humanistic cultural studies perspectives ranging to scientific plant biology, phenological modeling, and climatology studies.

@Acevedo2021 provides a rich cultural context for understanding cherry blossom phenology in Kyoto. Her research highlights a 1200-year flowering record of *Prunus jamasakura* in Kyoto, describing it as "the longest and most complete phenological record in existence." These records, compiled from imperial court documents, poetry, and newspaper accounts of *hanami* celebrations, reveal that Kyoto's cherry trees have responded to major climate fluctuations throughout history, with progressive advancement in bloom dates occurring after approximately 1830. This shift aligns with the end of the Little Ice Age and the onset of modern warming trends. Beyond scientific significance, Acevedo explores how sakura in Kyoto have traditionally served as indicators of agricultural prosperity, with early-falling petals considered inauspicious for rice harvests, demonstrating their enduring role as both cultural and climatic storytellers in Japanese society.

According to @Aono2008, cherry trees in Kyoto are currently experiencing warmer conditions than at any time in the past twelve centuries, resulting in average flowering dates that are seven days earlier in the 1971-2000 period compared to historical averages.

Next, Xu et al.'s research provides significant physiological evidence supporting the temperature-flowering relationship in cherry trees [@Xu2023]. Their study not only documented how temperature fluctuations caused 2-3 day shifts in flowering periods between 2016-2017, but also established varying cold tolerance rankings among cherry varieties that influence bloom timing. The authors revealed the underlying hormonal mechanisms—specifically changes in ABA, ZR, IAA, and GA3 levels—that regulate flower bud differentiation in response to temperature changes. This work strengthens our understanding of how temperature directly affects cherry blossom phenology through specific physiological pathways, offering valuable context for examining historical sakura flowering records in Kyoto and predicting how future climate patterns might alter traditional bloom timing.

@Allen2014, "Modeling daily flowering probabilities" offers an approach to rigorous quantitative predictions about cherry blossom phenology under climate change in Japan. They analyzed four cherry taxa (Prunus spachiana, P. × yedoensis, P. jamasakura, and P. lannesiana) using flexible Bayesian survival regression models applied to a 29-year dataset from Tama Forest Cherry Preservation Garden in Hachioji. Their approach incorporated both chilling requirements and heat accumulation mechanisms, finding that early-flowering species like *P. spachiana* were particularly sensitive to warming temperatures. The models predicted that all studied cherry taxa will flower approximately 30 days earlier by 2100 under the A1B emissions scenario, with 2-6 days greater uncertainty around mean flowering dates. Allen et al. found that sequential models (where trees require chilling before responding to warming) better predicted flowering times than simpler approaches. The study demonstrates that while cherry trees will continue to meet their chilling requirements under projected climate scenarios, accelerated heat accumulation will drive the dramatic advancement in flowering times.

# Data {#sec-data}

To investigate the relationship between mean March temperature and blooming date in Kyoto, historical data on cherry blossom blooming dates [@Aono2010], as well as data collected through modern measurement techniques [@JMA_sakura] [@JMA_temp] were analyzed. @Cookson provided both datasets assembled in a single repository, though the modern data sources were last updated in 2020.

All of the data was transformed in Python [@python], using the `pandas` [@pandas] and `numpy` [@numpy] packages. For this analysis, the average (mean) march temperature, bloom date, day of year of blooming and year were made of interest.

In the historical data, @Aono2010 reconstructs the mean march temperature in Kyoto for some of the years, based on the blooming date, but also provided observed temperatures taken from local newspapers for a given year when possible. We prioritized used observed temperatures, but if none were available, then the reconstructed one was used. This created a dataset of 827 observations, from the year 812-2015. A sample of the table can be seen in @tbl-historical.

```{python}
#| label: tbl-historical
#| tbl-cap: "Historical Cherry Blossom Blooming"

# Rename columns for better readability
historic_bloom_renamed = historic_bloom.rename(columns={
    'year': 'Year',
    'flower_date': 'Bloom Date',
    'flower_doy': 'Day of Year',
    'avg_temp_march_c': 'March Temp (°C)'
})

# Display the table without .style.set_caption()
display(historic_bloom_renamed.head())
```

With the modern data, @Cookson combined average monthly temperatures and blooming date in a single dataset for several cities across Japan. We filtered this data to solely Kyoto, and solely average march temperatures to match the historical data from @Aono2010. This created a dataset with 67 observations ranging from 1953 to 2015. A sample can be seen in @tbl-modern.

```{python}
#| label: tbl-modern
#| tbl-cap: "Modern Cherry Blossom Blooming"

# Rename columns for better readability
modern_bloom_renamed = modern_bloom.rename(columns={
    'year': 'Year',
    'flower_date': 'Bloom Date',
    'flower_doy': 'Day of Year',
    'avg_temp_march_c': 'March Temp (°C)'
})

# Display the table without .style.set_caption()
display(modern_bloom_renamed.head())
```

In our data exploration, the `matplotlib` [@matplotlib] and `seaborn` [@seaborn] packages were used to visualize and explore the data. The historical dataset was visualized and explored first.


```{python}
#| label: fig-hist-temp-yr-scatter
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

# Scatterplot of historic temp vs years 
plt.figure(figsize=(10, 6))

# Scatter plot with pink points
plt.scatter(historic['year'], historic['avg_temp_march_c'], alpha=0.7, color='#FF9ECD', edgecolor='#E75480', s=50)

# Add moving average line
moving_avg = historic['avg_temp_march_c'].rolling(window=10).mean()
plt.plot(historic['year'], moving_avg, color='#5F3E2A', linewidth=2.5, label='10-Year Moving Avg')

# Add reference line for mean temperature
mean_temp = historic['avg_temp_march_c'].mean()
plt.axhline(y=mean_temp, color='skyblue', linestyle='--', label=f'Historical Mean ({mean_temp:.1f}°C)')

# Add labels and customize
plt.title('Historic Temperature vs Year', fontsize=16)
plt.xlabel('Year', fontsize=12)
plt.ylabel('Temperature (°C)', fontsize=12)
plt.grid(True, alpha=0.3)
plt.legend()

plt.tight_layout()
```

@fig-hist-temp-yr-scatter displays historical annual temperature records (in °C) from the year 800 CE to 2000 CE. Each pink dot represents the recorded temperature for a given year, while the solid teal line represents a 10-year moving average, smoothing out year-to-year fluctuations to highlight longer-term trends. The dashed horizontal line represents the historical mean temperature of 6.2°C. Notably, the data show considerable fluctuations over the centuries, with a relatively stable pattern through much of the pre-industrial era. However, a sharp and continuous rise in average temperature is observed beginning in the late 19th to early 20th century, suggesting significant warming recently. This trend aligns with broader patterns of climate change and may have implications for phenological events such as the timing of sakura (cherry blossom) flowering.

```{python}
#| label: fig-hist-bloomday-yr
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

# Create simplified flowering day history plot
plt.figure(figsize=(10, 6))

# Filter out NaN values
filtered_historic = historic.dropna(subset=['flower_doy'])

# Create scatter plot 
plt.scatter(filtered_historic['year'], filtered_historic['flower_doy'], 
            alpha=0.7, color='#FF9ECD', edgecolor='#E75480', s=40)

# Add moving average line
moving_avg = filtered_historic['flower_doy'].rolling(window=10).mean()
plt.plot(filtered_historic['year'], moving_avg, 
         color='#6E4B34', linewidth=2, label='10-Year Moving Avg')

# Add reference line for historical mean
mean_doy = filtered_historic['flower_doy'].mean()
plt.axhline(y=mean_doy, color='#87CEFA', linestyle='--', 
            label=f'Historical Mean ({mean_doy:.1f}, April 13-14)')

# Set up secondary y-axis for date labels
ax = plt.gca()
ax2 = ax.twinx()
y_min, y_max = ax.get_ylim()
y_min, y_max = int(y_min), int(y_max)

# Create date labels
doy_values = np.arange(y_min - (y_min % 10), y_max + 10, 10)  # Ticks every 10 days
date_labels = []
months = {3: 'Mar', 4: 'Apr', 5: 'May', 6: 'Jun'}

for doy in doy_values:
    # Convert DOY to month/day
    if doy <= 90:
        date_labels.append(f'{months[3]} {doy-59}')
    elif doy <= 120:
        date_labels.append(f'{months[4]} {doy-90+1}')
    elif doy <= 151:
        date_labels.append(f'{months[5]} {doy-120+1}')
    else:
        date_labels.append(f'{months[6]} {doy-151+1}')

# Apply secondary axis settings
ax2.set_ylim(y_min, y_max)
ax2.set_yticks(doy_values)
ax2.set_yticklabels(date_labels)
ax2.set_ylabel('Approximate Date', color='#4BA3C3')

# Customize appearance
plt.title('Cherry Blossom Flowering Day Throughout History', fontsize=14)
plt.xlabel('Year')
plt.ylabel('Day of Year (DOY)')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
```

@fig-hist-bloomday-yr showcases the annual full flowering dates of sakura from 800 to 2000 CE, plotted as day-of-year (DOY) values, where higher values indicate later blooming in the calendar year. Each pink dot corresponds to an individual year's observed full bloom date, and the solid brown line shows a 10-year moving average; the dashed horizontal line indicates the historical mean, which is 104.6. The data suggest that while flowering dates have fluctuated across centuries, a notable trend toward earlier blooming began in the late 19th and 20th centuries. This shift coincides with the period of modern climate warming seen in the corresponding temperature graph, suggesting that rising spring temperatures are advancing sakura bloom time. 

```{python}
#| label: fig-hist-violin-plot  
#| message: false
#| echo: false
#| warning: false
#| fig-align: center


# Violin Plot 
plt.figure(figsize=(14, 8))

# Create century labels based on year
if 'century_label' not in historic.columns:
    century_num = (historic['year'] // 100 + 1).astype(int)
    historic['century_label'] = century_num.apply(lambda x: f"{x}{'th' if x not in [1, 2, 3, 21] else ['st', 'nd', 'rd', 'st'][x % 10 - 1 if x % 100 != 11 else 0]}")

# Define centuries in chronological order
century_order = [f"{i}{'th' if i not in [21] else 'st'}" for i in range(9, 22)]

# Create a color gradient from light blue to pink
colors = ['#ADD8E6', '#FFC0CB']  # Light blue to Light pink
cm = LinearSegmentedColormap.from_list('blue_to_pink', colors, N=len(century_order))
custom_palette = {century: cm(i/float(len(century_order)-1)) for i, century in enumerate(century_order)}

# Create violin plot
sns.violinplot(x='century_label', y='flower_doy', data=historic, 
               palette=custom_palette, inner='quartile', order=century_order)

# Add data points
sns.stripplot(x='century_label', y='flower_doy', data=historic, 
              color='#FF9ECD', alpha=0.3, jitter=True, size=4, order=century_order)

# Add mean reference line
mean_doy = historic['flower_doy'].mean()
plt.axhline(y=mean_doy, color='#E75480', linestyle='--', 
            label=f'Historical Mean ({mean_doy:.1f}, April 14)')

# Set titles and labels
plt.title('Cherry Blossom Flowering Day Distribution by Century', fontsize=18, color='#E75480')
plt.xlabel('Century', fontsize=14, color='#4BA3C3')
plt.ylabel('Day of Year (DOY)', fontsize=14, color='#4BA3C3')
plt.xticks(rotation=45, color='#4F86C6')

# Add secondary y-axis with calendar dates
ax = plt.gca()
ax2 = ax.twinx()
y_min, y_max = ax.get_ylim()
doy_values = range(int(y_min), int(y_max) + 1, 10)  # Ticks every 10 days

# Create date labels
date_labels = []
for doy in doy_values:
    if doy < 90:
        date_labels.append(f'Mar {doy - 59}')
    elif doy < 120:
        date_labels.append(f'Apr {doy - 90 + 1}')
    elif doy < 151:
        date_labels.append(f'May {doy - 120 + 1}')
    else:
        date_labels.append(f'Jun {doy - 151 + 1}')

ax2.set_ylim(y_min, y_max)
ax2.set_yticks(doy_values)
ax2.set_yticklabels(date_labels)
ax2.set_ylabel('Approximate Date', color='#4BA3C3', fontsize=14)

plt.legend()
plt.grid(True, alpha=0.3, axis='y')
plt.tight_layout()
```

@fig-hist-violin-plot showcases the cherry blossom flowering date distribution by century (9th to 21st), measured in day-of-year (DOY). The dashed pink line represents the average flowering day of the year (~105 days). It was quite consistent until the 20th century (1900s), where we can see a large drop; this trend has also been carried into the 21st century, where it dropped further. 

A common thread emerges across all of the plots - warmer temperatures as time goes on has led to cherry blossoms blooming earlier and earlier every year.Furthermorethe significant shifting blooming days relative to temperature point to this historical data being ineffective in understanding the present relationship between temperature and blooming day. Since blooming days and temperatures have shifted so much in the last 150 years, examining more modern data is more effective in uncovering current trends. Given this, another more current dataset from @Cookson was examined next. 

```{python}
#| label: fig-modern-year-temp 
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

# Scatterplot of modern year vs flowering day
plt.figure(figsize=(12, 7))

# Create scatter plot
plt.scatter(modern['year'], modern['flower_doy'], 
            alpha=0.7, color='#FF9ECD', edgecolor='#E75480', s=50)

# Add moving average line
moving_avg = modern['flower_doy'].rolling(window=5).mean()
plt.plot(modern['year'], moving_avg, color='#6E4B34', linewidth=2.5, 
         label='5-Year Moving Avg')

# Customize plot appearance
plt.title('Cherry Blossom Flowering Day Throughout Modern Times', fontsize=16, color='#E75480')
plt.xlabel('Year', fontsize=12, color='#4BA3C3')
plt.ylabel('Day of Year (DOY)', fontsize=12, color='#4BA3C3')
plt.grid(True, alpha=0.3)

# Create secondary y-axis with date labels
ax = plt.gca()
ax2 = ax.twinx()
y_min, y_max = ax.get_ylim()
doy_values = np.arange(int(y_min), int(y_max) + 1, 5)
date_labels = []

for doy in doy_values:
    if doy < 90:
        date_labels.append(f'Mar {doy-59}')
    elif doy < 120:
        date_labels.append(f'Apr {doy-90+1}')
    elif doy < 151:
        date_labels.append(f'May {doy-120+1}')
    else:
        date_labels.append(f'Jun {doy-151+1}')

ax2.set_ylim(y_min, y_max)
ax2.set_yticks(doy_values)
ax2.set_yticklabels(date_labels)
ax2.set_ylabel('Approximate Date', color='#4BA3C3')

plt.legend()
plt.tight_layout()
```

@fig-modern-year-temp above presents the annual full flowering dates of cherry blossoms in Japan from 1950 to 2020, measured in day-of-year (DOY), where higher values represent later blooming. Each pink dot marks the full flowering day for a given year, while the solid blue line shows a 5-year moving average, smoothing short-term fluctuations to reveal broader temporal trends. Over the 70-year span, there is a clear downward trend, indicating progressively earlier flowering.

```{python}
#| label: fig-modern-bloomday-yr
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

# scatterplot of modern data - year vs. Temperature

# Scatterplot of modern temp vs years 
sns.set(style="whitegrid")
plt.figure(figsize=(10, 6))

# Create a custom pink/light blue color palette
pink_blue_colors = ['#FF9ECD', '#87CEFA']  # Light pink and light blue
custom_cmap = LinearSegmentedColormap.from_list('pink_blue', pink_blue_colors)

# Scatter plot with pink color
plt.scatter(modern['year'], modern['avg_temp_march_c'], alpha=0.7, color='#FF9ECD', edgecolor='#E75480', s=50)

# Add moving average line in light blue
modern['moving_avg'] = modern['avg_temp_march_c'].rolling(window=5).mean()  # Using 5-year window for modern data
plt.plot(modern['year'], modern['moving_avg'], color='#6E4B34', linewidth=2.5, label='5-Year Moving Avg')

plt.legend(framealpha=0.7)

# Customize the plot with pink/blue theme
plt.title('Modern Temperature vs Year', fontsize=16, color='#E75480')
plt.xlabel('Year', fontsize=12, color='#4BA3C3')
plt.ylabel('Temperature (°C)', fontsize=12, color='#4BA3C3')
plt.xticks(rotation=45, color='#4F86C6')
plt.yticks(color='#4F86C6')
plt.grid(True, alpha=0.3, color='#E0E0E0')

plt.tight_layout()
```

@fig-modern-bloomday-yr shows the annual spring temperature in Japan from 1950 to 2020, measured in degrees Celsius (°C) relative to a baseline average. Each pink dot represents the average March temperature for a given year, and the solid blue line indicates a 5-year moving average to highlight underlying climate trends. The overall trajectory shows a clear increase in average March temperatures over the 70-year period, particularly after 1990, reflecting the impact of modern global climate change. This warming trend corresponds closely with the earlier flowering of cherry blossoms during the same time frame shown in the earlier figure. Together, both graphs reinforce the connection between rising spring temperatures and timing shifts in sakura blooming.


```{python}
#| label: fig-modern-temps-hist
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

# histogram of temperatures
plt.figure(figsize=(12, 7))
plt.hist(modern['avg_temp_march_c'], bins=30, color='#FF9ECD', edgecolor='#E75480', alpha=0.7)
plt.title('Distribution of Average March Temperatures (Modern)', fontsize=18, color='#E75480')
plt.xlabel('Temperature (°C)', fontsize=14, color='#4BA3C3')
plt.ylabel('Frequency', fontsize=14, color='#4BA3C3')
plt.xticks(color='#4F86C6')
plt.yticks(color='#4F86C6')
plt.legend(framealpha=0.7)
plt.grid(True, alpha=0.3, color='#E0E0E0')
plt.tight_layout()
```

@fig-modern-temps-hist above presents the frequency distribution of average March temperatures in Japan from 1950 to 2020. The temperature values are plotted on the x-axis in degrees Celsius (°C). The distribution is centered around -1.5°C, with a wider spread toward colder extremes and a thinner tail extending into positive temperatures. While most March temperatures during this period fall below freezing, the presence of warmer years, particularly in the latter decades, indicates a shift in climate norms. These warming trends align with observed shifts in cherry blossom phenology, where earlier flowering is increasingly correlated with milder spring conditions.

```{python}
#| label: fig-modern-flowering-days-hist
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

# histogram of flowering days
plt.figure(figsize=(12, 7))
plt.hist(modern['flower_doy'], bins=30, color='#FF9ECD', edgecolor='#E75480', alpha=0.7)
plt.title('Distribution of Flowering Days (Modern)', fontsize=18, color='#E75480')
plt.xlabel('Day of Year (DOY)', fontsize=14, color='#4BA3C3')
plt.ylabel('Frequency', fontsize=14, color='#4BA3C3')
plt.xticks(color='#4F86C6')
plt.yticks(color='#4F86C6')
plt.legend(framealpha=0.7)
plt.grid(True, alpha=0.3, color='#E0E0E0')
plt.tight_layout()
plt.show()
```

@fig-modern-flowering-days-hist highlights the frequency distribution of sakura full flowering dates in modern Japan, measured in day-of-year (DOY), for the period between 1950 and 2020. Each bar represents how often flowering occurred within a specific DOY range. The distribution is roughly normally distributed, with the majority of flowering dates clustered between DOY 83 and DOY 95 (approximately March 24 to April 4), suggesting a central tendency in late March. 

Exploring the data collected in the last 60 years has highlighted it's similarity to the  historical dataset. As temperatures have gotten warmer, cherry blossoms in Kyoto have tended to bloom earlier and earlier as the years have progressed. Although the temperatures in the modern dataset tend to be a bit cooler on average than the ones noted in the historical dataset, the clear negative relationship between temperature and blooming day endures. To be able to more exactly quantify this relationship, however, we construct a model. 


# Modeling {#sec-model}

After data exploration, various modeling approaches were considered before selecting OLS regression as the most appropriate method. We were interested in investigating the relationship between sakura blooming times and the average temperature in March of the given year. The independent variable will be that of the temperature, with the dependent/responding variable being the time of blooming.

A Cox Proportional Hazards model was initially evaluated, inspired by the Bayesian Survival model used in @Allen2014. This approach was deemed unsuitable due to its emphasis on censored data rather than structurally missing entries which characterized much of the historical dataset. Additionally, the interpretive framework of hazard ratios and survival probabilities was not aligned with the explanatory objectives of this analysis.

Poisson regression was also assessed but rejected due to overdispersion in the dependent variable (day of year of sakura blooming) and its normal distribution, which violated key assumptions required for proper model interpretation.

The final consideration was between Ordinary Least Squares regression and Regression Tree models. OLS regression was ultimately selected based on the dataset structure and need for interpretability. Its coefficient-based output allowed for straightforward quantification and interpretation of the relationship between temperature and blooming times.

## Model Specification

The aim of computing this OLS regression model is to estimate an equation for a line with the coefficients β so that the differences (errors) between the predicted line and the data points are minimized. By doing this, we get an equation for a line that best fits the data, allowing for the estimation of blooming dates given the average March temperatures in a given year. With the OLS regression, we will determine and predict one single outcome variable, blooming day.

The equation for our linear model is written as:

$$
\text{Blooming\_DoY}_i = \beta_0 + \beta_1 \cdot \text{March\_Temp}_i + \varepsilon_i
$$

\newpage

The dependent variable Blooming Day represents the blooming day of a Kyoto cherry blossoms in a given year. It is measured in days after January 1 of a given year. 

The independent variable March Temperature, described by the slope coefficient $\beta_1$, denotes the mean March temperature of the given year, which is measured in celsius. 

## Results

```{python}
# Load dataset
df = modern_bloom

# Rename columns for clarity
df.columns = ['year', 'flower_date', 'flower_doy', 'march_temp_c']

# Split into training (1953–2000) and testing (2010–2019)
train_df = df[df['year'] <= 2000]
test_df = df[(df['year'] >= 2009) & (df['year'] <= 2019)]

# Define X and y
X = sm.add_constant(train_df['march_temp_c'])  # Add intercept
y = train_df['flower_doy']

# Fit model 1
model_0 = sm.OLS(y, X).fit()

# Fit model 2 (with robust standard errors)
model_1 = sm.OLS(y, X).fit(cov_type='HC1')

```

```{python}
#| label: tbl-reg-results
#| tbl-cap: "Regression Results for Cherry Blossom Flowering Day vs. March Temperature"
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

# Extract model results in a cleaner format
results_table = summary_col([model_0, model_1], 
                          model_names=["Standard OLS", "Robust OLS"],
                          float_format='%0.3f',
                          info_dict={'N':lambda x: "{0:d}".format(int(x.nobs)),
                                    'R2':lambda x: "{:.3f}".format(x.rsquared)})
# Display the table
display(results_table)
```

The regression analysis in @tbl-reg-results, visualized in @fig-reg-plt, reveals a significant inverse relationship between March temperature and cherry blossom blooming dates. For each 1°C increase in March temperature, cherry blossoms bloom approximately 2.25 days earlier (p < 0.01). This relationship remains consistent across both standard and robust OLS models, though the latter shows larger standard errors, suggesting heteroscedasticity in the data. With an R-squared of 0.32, March temperature appears to explain about one-third of the variation in blooming dates. When March temperature is 0°C, blossoms are predicted to emerge on the 88th day of the year (late March). These findings indicate that spring temperature serves as a meaningful predictor of cherry blossom phenology. Diagnostic plots are in @sec-appendix-1

```{python}
#| label: fig-reg-plt 
#| fig-cap: "Regression Visualization"
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

# Simple scatterplot with regression line
plt.figure(figsize=(8, 4))
plt.scatter(df['march_temp_c'], df['flower_doy'], color='#FF9ECD', edgecolor='#E75480', alpha=0.7)

plt.plot(sorted(df['march_temp_c']), model_0.predict(sm.add_constant(sorted(df['march_temp_c']))), color='red')

plt.text(0.1, 95, f"blooming_day = {model_0.params[1]:.2f} * temp + {model_0.params[0]:.2f}", color="red", fontsize=12)

plt.title("Sakura Blooming Day vs March Temperature")
plt.xlabel("March Avg Temperature (°C)")
plt.ylabel("Blooming Day of Year (DoY)")
plt.show()
```

\newpage

# Discussion {#sec-discussion}

## Implications of Findings
Our statistical analysis reveals a significant inverse relationship between pre-flowering March temperatures and sakura bloom dates, with higher temperatures consistently associated with earlier flowering time. This temperature-dependent pattern aligns with the documented global warming trend observed over recent centuries, particularly the accelerated temperature increase in the modern era. The predictive models generated through our research demonstrate robust statistical evidence that the progressive elevation of mean March temperatures, driven by global warming, will likely continue to advance cherry blossom flowering dates in coming decades. Our findings corroborate the projections established by Allen et al. in their seminal work on phenological responses to climate change [@Allen2014]; their model, as discussed in our literature review, similarly predicted accelerated advancement of flowering dates under various warming scenarios, with comparable directional trends to those observed in our analysis. This convergence of independent methodological approaches strengthens the validity of both models and provides additional confirmation of the phenological impacts of climate alteration on various sakura species.

## Ecological Implications
The observed advancement in sakura flowering dates correlates with increasing mean March temperatures in our analysis, highlighting a significant climate-driven phenological shift. This temperature-phenology relationship aligns with a growing body of research on plant responses to climate change. As @Rahimi2025 observed in their comprehensive analysis of pollinator-dependent crops across Asia, climate change is driving significant spatial and temporal shifts in biological systems, particularly affecting species interactions that depend on synchronized timing.

The earlier flowering of sakura represents a classic example of phenological mismatch—where interacting species respond differently to climate cues, potentially disrupting ecological relationships. @Gerard2020 highlight that "many phenological shifts have already been reported at the species level for the insect emergence or blooming time of flowering plants", with temperature being the predominant driver. However, these shifts are rarely uniform across different ecological levels, creating potential desynchronization between plants and their pollinators or other dependent species.

The observed advancement in sakura blooming could have cascading effects throughout Japanese ecosystems. As @Rahimi2025 identified in their spatial mismatch analysis, when flowering phenology changes, it can disrupt the "critical synchronizations" between flowers and their respective pollinators, potentially affecting ecosystem functionality and biodiversity dynamics. In addition, not limited to spatial mismatch, Rahimi and Jung argue that temporal mismatch is also possible in the future. It will occur when the "flowering periods of plants and the activity periods of their pollinators are no longer synchronized", reducing pollination efficiency and crop yields. This phenomenon will be a likely future if global warming continues to worsen and average March temperature steadily increases.

The continued warming projected in climate models suggests that the trend toward earlier sakura flowering will likely accelerate in coming decades, potentially creating novel ecological communities as species respond differentially to changing conditions.

## Cultural Implications
As established in @sec-lit-review, that tradition of Hanami is a staple in Japanese culture. Moreover, it has become a significant source of revenue for both the nation itself and the local communities which host associated festivals. Our findings reveal a significant relationship between pre-flowering temperatures and blooming dates, aligning closely with observed patterns with climate-change related temperature increases. As the Hanami/cherry blossom festivals draw significant international and domestic attention, the scheduling of these events must be exhaustive in order to facilitate them at the scale they reach (and continue to grow). While we don’t anticipate a significant disruption to the bloom itself, understanding when the bloom will start is critical to maintaining the economic momentum these festivals have demonstrated. Furthermore, cherry blossoms and the Hanami practice are significant beyond their economic benefits. Communities and citizens celebrate and find great meaning and importance in these practices. Understanding that the bloom may come earlier, and being able to plan for travel, accommodations, and individual scheduling is important to many people in Japan. We expect that, if temperatures continue to raise year over year, it may disrupt the lives/scheduling of communities in Japan which find great importance in observing cherry blossom blooming every year.

## Limitations
There are several limitations to this analysis. First, our analysis relies predominantly on data from Kyoto, representing a geographically limited subset that may not comprehensively reflect sakura phenological patterns across Japan's diverse climate regions. Second, although we used a merged dataset spanning from 800 CE to 2019, there are significant data gaps/missing values where we have to drop during the cleaning & merging of the two dataset. In addition, a notable limitation is the historical dataset's reliability, as large portions comprise of reconstructed values derived from local linear regression models or originated from primary sources that lack rigorous academic verification protocols. This presents challenges for establishing data provenance and reliability in accordance with contemporary scientific standards. Lastly, while our findings highlight temperature as a statistically significant predictor of bloom timing, the single-variable approach inherently overlooks other potential ecological factors. Variables such as precipitation patterns, photoperiod fluctuations, soil conditions, and winter chilling requirements may also contribute significantly to the observed advancement in flowering dates. A more comprehensive multivariate model, comprising more reliable data would potentially yield enhanced predictive capacity and ecological insights.

## Future Research Directions
For future research, we would like to establish regression tree models to enhance predictive capabilities regarding sakura phenological patterns. Unlike traditional linear models, regression trees offer robust forecasting mechanisms that can better accommodate complex interactions between variables, prioritizing predictive accuracy over interpretive simplicity. Next, we recommend adding in additional environmental parameters beyond temperature. Variables warranting investigation including but not limited to precipitation frequency and intensity, atmospheric humidity gradients, soil composition metrics, photoperiod fluctuations, and cumulative chilling units during dormancy periods. Such multidimensional modeling would potentially explain a greater proportion of the observed variability in bloom timing and provide more nuanced insights into the complex biological mechanisms governing cherry blossom phenology. Lastly, future research could benefit from expanding the geographical scope beyond Kyoto to establish comparative phenological datasets across diverse microclimates and latitudinal gradients throughout Japan and other regions where cherry trees are important. This expanded spatial analysis would facilitate the identification of region-specific responses to climate variables and potentially isolate genetic adaptations to local environmental conditions.

## Conclusion
The Japanese tradition of *hanami*  is an important cultural tradition that honors the cycle of life and death. However, rising global temperatures have created an anomaly in recent years, highlighting the need to understand the historical and modern links between temperature and cherry blossom bloom timing. By exploring and modelling this data, we began to understand the quantitative relationships between temperature and blooming day. Changes in temperature will have consequential effects for wildlife that function around the timing of blooming *sakura*. Next, the timing of celebrations such as *hanami* will be impacted by temperature changes, necessitating flexibility in honouring this tradition. Finally, there is a need for more a more comprehensive inquiry into the determinants of cherry blossom blooming, beyond solely the locale of Kyoto. This is so that more robust predictions of *sakura* blooming in Kyoto can be made. By gathering more data to make better predictions, the city of Kyoto will be better able to weather climate change and bridge their cherished traditions into the future. 

\newpage

# References

::: {#refs}
:::

\newpage

\appendix

# Appendix {#sec-appendix}

## Code for Plots

The code used to render the plots and tables in this paper can be found at <https://github.com/lcarnegie/sakura/tree/main/scripts> 

## Diagnostic Plots for OLS Models {#sec-appendix-1}

```{python}
#| fig-cap: "Diagnostic Results for Cherry Blossom Flowering Day vs. March Temperature"
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

# Add necessary libraries for diagnostic plots
import statsmodels.api as sm
from statsmodels.graphics.gofplots import qqplot
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

# Create diagnostic plots for the OLS model
fig = plt.figure(figsize=(20, 15))

# Residual vs Fitted Plot
ax = fig.add_subplot(1, 1, 1)
residuals = model_0.resid
fitted = model_0.fittedvalues
sns.residplot(x=fitted, y=residuals, lowess=True, scatter_kws={'alpha': 0.5}, line_kws={'color': 'red', 'lw': 1}, ax=ax)
ax.set_title('Residuals vs Fitted')
ax.set_xlabel('Fitted values')
ax.set_ylabel('Residuals')
ax.axhline(y=0, color='k', linestyle='-', alpha=0.3)
```

```{python}
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

import statsmodels.api as sm
from statsmodels.graphics.gofplots import qqplot
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

# Create diagnostic plots for the OLS model
fig = plt.figure(figsize=(10, 8))
ax = plt.subplot(111)

# QQ Plot for Normality
qqplot(model_0.resid, line='s', ax=ax)
ax.set_title('Normal Q-Q')
ax.set_xlabel('Theoretical Quantiles')
ax.set_ylabel('Standardized Residuals')
```

```{python}
#| message: false
#| echo: false
#| warning: false
#| fig-align: center

# Add necessary libraries for diagnostic plots
import statsmodels.api as sm
from statsmodels.graphics.gofplots import qqplot
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

# Create diagnostic plots for the OLS model
fig = plt.figure(figsize=(10, 8))

# Scale-Location Plot (Square root of absolute residuals vs fitted)
ax = fig.add_subplot(2, 2, 3)
sqrt_abs_resid = np.sqrt(np.abs(residuals))
sns.regplot(x=fitted, y=sqrt_abs_resid, lowess=True, scatter_kws={'alpha': 0.5}, line_kws={'color': 'red', 'lw': 1}, ax=ax)
ax.set_title('Scale-Location')
ax.set_xlabel('Fitted values')
ax.set_ylabel('$\\sqrt{|Standardized Residuals|}$')

```

```{python}
#| message: false
#| echo: false
#| warning: false
#| fig-align: center


# Add necessary libraries for diagnostic plots
import statsmodels.api as sm
from statsmodels.graphics.gofplots import qqplot
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

# Leverage vs. Standardized Residuals
fig = plt.figure(figsize=(10, 8))
ax = fig.add_subplot(1, 1, 1)
infl = model_0.get_influence()
hatvals = infl.hat_matrix_diag
stud_resid = infl.resid_studentized_external

# Determine leverage threshold
p = len(model_0.params)  # number of parameters
leverage_threshold = 2 * p / len(hatvals)

# Plot points
ax.scatter(hatvals, stud_resid, alpha=0.6)
ax.axhline(y=0, color='k', linestyle='-', alpha=0.3)

# Add reference lines
ax.axhline(y=2, color='g', linestyle='--', label='Std. Residuals = 2')
ax.axhline(y=-2, color='g', linestyle='--')
ax.axvline(x=leverage_threshold, color='b', linestyle='--', 
           label=f'Leverage threshold ({leverage_threshold:.3f})')

# Highlight and label influential points (leverage > threshold or std. residuals > 2)
influential_points = []
for i in range(len(hatvals)):
    if (abs(stud_resid[i]) > 2) or (hatvals[i] > leverage_threshold):
        ax.text(hatvals[i], stud_resid[i], 
                f" {i} ({hatvals[i]:.3f}, {stud_resid[i]:.2f})", 
                fontsize=9, color="red")
        influential_points.append(i)

ax.set_title('Leverage vs. Standardized Residuals')
ax.set_xlabel('Leverage (hat values)')
ax.set_ylabel('Studentized Residuals')
ax.legend(loc='upper right', fontsize=8)
plt.tight_layout()
```